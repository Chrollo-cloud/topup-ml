<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Top Up ML</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <div class="container">
    <div class="card">
      <h2>Top Up Mobile Legends</h2>

      <form id="topupForm">

        <label>ML User ID</label>
        <input type="text" id="ml_id" required />

        <label>Server</label>
        <input type="text" id="server" required />

        <label>Pilih Nominal Diamond</label>

        <!-- ðŸ”‘ GRID WAJIB -->
        <div class="diamond-grid">

          <div class="diamond-card" data-diamond="86" data-price="20000">
            <img src="assets/diamond.png" class="diamond-icon" />
            <strong>86 Diamond</strong>
            <span>Rp 20.000</span>
          </div>

          <div class="diamond-card" data-diamond="172" data-price="40000">
            <img src="assets/diamond.png" class="diamond-icon" />
            <strong>172 Diamond</strong>
            <span>Rp 40.000</span>
          </div>

          <div class="diamond-card" data-diamond="257" data-price="60000">
            <img src="assets/diamond.png" class="diamond-icon" />
            <strong>257 Diamond</strong>
            <span>Rp 60.000</span>
          </div>

          <div class="diamond-card" data-diamond="500" data-price="110000">
            <img src="assets/diamond.png" class="diamond-icon" />
            <strong>500 Diamond</strong>
            <span>Rp 110.000</span>
          </div>

          <div class="diamond-card" data-diamond="1000" data-price="210000">
            <img src="assets/diamond.png" class="diamond-icon" />
            <strong>1000 Diamond</strong>
            <span>Rp 210.000</span>
          </div>

        </div>

        <input type="hidden" id="diamond" />

        <div class="price-box">
          <span>Total Harga</span>
          <strong id="priceDisplay">-</strong>
        </div>

        <button type="submit">Buy Now</button>
      </form>
    </div>
  </div>

  <script>
    let selectedDiamond = null;
    let selectedPrice = null;

    const cards = document.querySelectorAll('.diamond-card');
    const diamondInput = document.getElementById('diamond');
    const priceDisplay = document.getElementById('priceDisplay');

    cards.forEach(card => {
      card.addEventListener('click', () => {
        cards.forEach(c => c.classList.remove('active'));
        card.classList.add('active');

        selectedDiamond = parseInt(card.dataset.diamond);
        selectedPrice = parseInt(card.dataset.price);

        diamondInput.value = selectedDiamond;
        priceDisplay.textContent = `Rp ${selectedPrice.toLocaleString()}`;
      });
    });

    document.getElementById('topupForm').addEventListener('submit', async (e) => {
      e.preventDefault();

      if (!selectedDiamond) {
        alert('Pilih nominal diamond terlebih dahulu');
        return;
      }

      const data = {
        ml_id: document.getElementById('ml_id').value,
        server: document.getElementById('server').value,
        diamond: selectedDiamond,
        price: selectedPrice
      };

      const response = await fetch('http://localhost:3000/api/orders', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      });

      if (response.ok) {
        window.location.href = 'success.html';
      } else {
        alert('Order gagal');
      }
    });
  </script>

</body>
</html>
